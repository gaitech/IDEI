<?php 

function idei_custom_node_view($node, $view_mode, $langcode) {
  $currentPath = current_path();
  $explodePath = explode("/",$currentPath);
  if($explodePath[0] != 'search') {
    // annual page redirect
    if($node->type == 'annual_reports') {
      drupal_goto("/annual-report-page");
    }
    // media page redirect
    if($node->type == 'media') {
      if($node->field_media_category['und'][0]['tid'] == 45) {
        drupal_goto("/awards-media");
      } else {
        drupal_goto("/media-listing");
      }     
    }
    //programmes redirection
    if($currentPath != 'node/37') {
      if($node->type == 'programms') {
        drupal_goto("/content/our-programmes");
      }
    }
    // Knowledge partner 
    if($node->type == 'knowledge_partners') {
      drupal_goto("/knowledge-partners");
    }
    // Global networking platform
    if($node->type == 'global_networking_platforms') {
      drupal_goto("/global-networking-platforms");
    }
    // Awards list redirect
    if($node->type == 'awards_list') {
      drupal_goto("/awards-timeline");
    }
    // Awards list redirect
    if($node->type == 'volunteers') {
      drupal_goto("/volunteers");
    }
    //Redirect to homepage 
    if($node->type == 'front_page_content') {
      drupal_goto("/");
    }

  }
}


/**
 * Implements hook_init().
 */
function idei_custom_init() {
  drupal_add_js(drupal_get_path('module', 'idei_custom') . '/js/jquery.anchor.js');
}
/**
* Implements hook_menu_alter().
*/

function idei_custom_menu_alter(&$items) {
  // Disable user password page 
  $items['user/password']['access callback'] = FALSE;
}

/**
* Implements hook_block_info().
*/
function idei_custom_block_info() {
  $blocks = array();

  $blocks['home_custom_menu'] = array(
    'info' => t('Home custom menu'),
  );
  $blocks['programs_custom_menu'] = array(
    'info' => t('Programs custom menu'),
  );
  $blocks['Products_gallery_tab_block'] = array(
    'info' => t('Product Tab Block'),
  );
  $blocks['water_inner_menu'] = array(
    'info' => t('Water inner page custom menu'),
  );
  $blocks['3d_slider'] = array(
    'info' => t('Water section 3D slider'),
  );
  $blocks['archive_paralax'] = array(
    'info' => t('Archive paralax menu block'),
  );
  $blocks['flip_slider'] = array(
    'info' => t('Water section flip slider'),
  );
  $blocks['thumb_slider'] = array(
    'info' => t('Water Thumbnail Slider'),
  );



  return $blocks;
}

/**
* Implements hook_block_view().
*/
function idei_custom_block_view($delta = '') {
  $block = array();

  switch ($delta) {
    case 'home_custom_menu':
      $block['subject'] = '';
      $block['content'] = idei_main_custom_navigation();
      break;
    case '3d_slider':
      $block['subject'] = '';
      $block['content'] = idei_3d_slider();
      break;
    case 'programs_custom_menu':
      $block['subject'] = '';
      $block['content'] = idei_program_navigation();
      break;
    case 'Products_gallery_tab_block':
      $block['subject'] = '';
      $block['content'] = program_tab_block();
      break;
    case 'water_inner_menu':
      $block['subject'] = '';
      $block['content'] = water_inner_page_menu();
      break;
    case 'archive_paralax':
      $block['subject'] = '';
      $block['content'] = archive_paralax();
      break;
    case 'flip_slider':
      $block['subject'] = '';
      $block['content'] = flip_slider();
      break;
    case 'thumb_slider':
      $block['subject'] = '';
      $block['content'] = thumb_sliders();
      break;
  }

  


  return $block;
}
/*
* Thumb slider for water Introduction
*/
function thumb_sliders(){
  return theme('water_thumb_slider');
}
/*
*3D Flip SLider 
*/
function flip_slider(){
return theme('water_flip_slider');
}

// archive_paralax
function archive_paralax(){
  return theme('archive_paralax');
}

//3D slider block
function idei_3d_slider(){
  drupal_add_js( drupal_get_path('module', 'idei_custom') . '/js/jquery.waterwheelCarousel.js');
 
  return theme('water_slider');
}
//function for water inner page menu
function water_inner_page_menu(){
  return theme('water_inner_menu');
}

function program_tab_block() {
  drupal_add_js( drupal_get_path('module', 'idei_custom') . '/js/easyResponsiveTabs.js');
  drupal_add_js( drupal_get_path('module', 'idei_custom') . '/js/responsiveTabs.js');
  drupal_add_css( drupal_get_path('module', 'idei_custom') . '/css/easy-responsive-tabs.css');
  return theme('program_tabs');
}


function idei_program_navigation(){
  return theme('idei_program');
}

/*
 * Implementation of hook_theme().
 */
function idei_custom_theme(){
  $templates = array(
    'idei_custom_block' => array(     
      'template' => 'templates/idei-custom-menu-new',
    ),
    'idei_program' => array(     
     'template' => 'templates/idei-programs-menu',
    ),
    'program_tabs' => array(
     'template' =>'templates/program-tab-block',
    ),
    'water_inner_menu' => array(
     'template' =>'templates/water-inner-menu',
    ),
    'water_slider' => array(
     'template' =>'templates/water-slider',
    ),
    'archive_paralax' => array(
     'template' =>'templates/archive-paralax-menu',
    ),
    'water_flip_slider' => array(
     'template' =>'templates/water-flip-slider',
    ),
    'water_thumb_slider' => array(
     'template' =>'templates/water-thumb-slider',
    ),     
    
  );
  return $templates;
}

function idei_main_custom_navigation() {
  return theme('idei_custom_block'); 
}

function idei_custom_form_alter(&$form, &$form_state, $form_id) {

  if($form_id == 'webform_client_form_68') {
    $argument = $_REQUEST['nid'];
    $node = node_load($argument);
    $type =$node->type;
    if($type == 'archive_documents') {
       $pdf_name = $node->field_pdf_file['und'][0]['uri'];
    }
    $pdf_name = explode("//",$pdf_name);
    $pdf = $pdf_name[1];
    global $base_url;
    $pdf_file_url = $base_url.'/sites/default/files/'.$pdf;
    $form['submitted']['url_path']['#default_value']= $pdf_file_url;
 }
}




